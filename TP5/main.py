import random
import numpy as np
from matplotlib import pyplot as plt

from TP3.src.Network import Network, layer_n_neurons, create_weighted_network
from TP3.src.Layer import Layer
from TP3.src.Neuron import Neuron
from TP3.src.perceptron import multilayer_perceptron
from TP3.src.theta_functions import hyp_tan_theta, hyp_tan_prime_theta, logistic_theta, logistic_prime_theta, \
    lineal_theta, lineal_prime_theta
from TP3.src.utils import compute_error_multilayer
from TP5.src.utils import get_letters, test_network


def pixel_error(output, expected):
    error = 0
    for i in range(len(output)):
        if output[i] > 0:
            if expected[i] != 1:
                error += 1
        else:
            if expected[i] != -1:
                error += 1
    return error


def main():
    letters_pattern = get_letters()
    # random.shuffle(letters_pattern)
    layer1 = layer_n_neurons(35, hyp_tan_theta, hyp_tan_prime_theta)
    layer2 = layer_n_neurons(25, hyp_tan_theta, hyp_tan_prime_theta)
    layer3 = layer_n_neurons(25, hyp_tan_theta, hyp_tan_prime_theta)
    layer4 = layer_n_neurons(2, hyp_tan_theta, hyp_tan_prime_theta, is_latent=True)
    layer5 = layer_n_neurons(25, hyp_tan_theta, hyp_tan_prime_theta)
    layer6 = layer_n_neurons(25, hyp_tan_theta, hyp_tan_prime_theta)
    layer7 = layer_n_neurons(35, hyp_tan_theta, hyp_tan_prime_theta)
    layer8 = layer_n_neurons(2, hyp_tan_theta, hyp_tan_prime_theta)
    layer9 = layer_n_neurons(20, hyp_tan_theta, hyp_tan_prime_theta)
    layer10 = layer_n_neurons(30, hyp_tan_theta, hyp_tan_prime_theta)
    layer11 = layer_n_neurons(35, hyp_tan_theta, hyp_tan_prime_theta)
    n = Network([layer2, layer4, layer5, layer7])

    n.initialize(input_count=35)
    array = letters_pattern[:10]
    error = multilayer_perceptron(letters_pattern, letters_pattern, compute_error_multilayer, 10000, 0.5, n)
    # n = create_weighted_network([[[-0.007623226899276862, 0.6379977084465845, -0.42350015181970485, 0.44160813448430225,
    #                                0.07198661718231007, -0.7573232003999759, -0.1263507337800636, 0.674787421511741,
    #                                -0.2001833965352593, -0.12003451353820459, 0.2225636271556391, 0.605004864332068,
    #                                -0.07792528955060236, -0.051641915284236665, 0.43582818097864323,
    #                                -0.2612295584150859, 0.23939246699588204, 0.06256379141275342, 0.5066839739423507,
    #                                0.4123901701321195, 0.490489007483885, 1.2350438150953669, -0.27341791055680237,
    #                                0.2959131422407619, 0.33916299183613424, -0.4416519685066489, 0.849426329583739,
    #                                -0.4255008929991786, 0.46469177892207625, 0.21891851081293365, -0.15195790388696714,
    #                                0.37370696075941645, 0.061402623211279574, -0.2753542214582582, 0.4106676846455109,
    #                                -0.6622086011877535],
    #                               [-0.08276608887305568, -0.23204161904731102, 0.46954450977130746, 0.8171409372379044,
    #                                0.6440913636596874, 1.477390430222572, -0.28741232726754046, 1.0792166098587483,
    #                                0.3801003704243475, 1.185629918659327, 0.30941082848657825, -0.5905483081343914,
    #                                0.6803952864385946, 0.39522904591322877, -0.3035982938101244, 0.08839025685237485,
    #                                -0.3457395971707567, 0.7493976490251913, 0.377709909516011, 0.25588357529901323,
    #                                -0.12159311362655263, 0.0885684245359895, -0.06793493698648603, 0.7685939995053238,
    #                                0.5189974089227382, -0.40599974418534, -0.20746217302196132, 0.6890669645593176,
    #                                0.16594132133371603, 0.5102674063061278, -0.420234962691332, -0.45626563788431546,
    #                                0.8337140208548255, 1.506483079813046, 0.1393522580855828, 0.19473463273454766],
    #                               [-0.35114182546349276, 0.15342411527257552, 0.11883245898130182,
    #                                -0.014513206650036128, 0.06997272541455384, 1.0803585891762508, 0.06406619608852686,
    #                                0.24356951970906981, -0.07420484348625549, 0.717829633841062, -0.05728986621001972,
    #                                -0.41788124998647075, -0.15958493645278268, -0.02224202442869068,
    #                                0.20207644583989015, 0.5123620044408086, -0.3734662961327745, 0.08990612894655273,
    #                                -0.15923909217510868, 0.13962682765332332, 0.15686458666060032, 0.40936106959885377,
    #                                -0.5275929842852031, 0.5185894793730191, 0.16679445081501443, 0.45541195431668696,
    #                                0.2065212155311261, -0.65142498932527, -0.07383013754399521, -0.28651414807270026,
    #                                0.7258241896987807, -0.4749131888544591, 0.6803407033679538, 0.2998499178795541,
    #                                -0.22498482827861543, -0.2902484347881228],
    #                               [-0.596935919697383, 0.985529320022508, -0.13955272854564738, 0.24250379402168573,
    #                                -0.4786678757050156, 0.13204857046465668, -0.1756467810777962, -0.30458788609397935,
    #                                0.434465684077769, 0.030324261337912297, -0.32102685153447225, 0.36272797140597995,
    #                                0.07653306063870913, -0.1874971263456946, -0.07056504600815643, 0.5445972904364234,
    #                                -0.2830203914982646, -0.2781019058855955, -0.38283921167781126, 0.21500244918617628,
    #                                -0.11692058360581647, 0.6989291719727402, 0.36327123021202173, -0.19805955274598097,
    #                                0.5224561305405062, 0.2980782309746022, 0.800394796930495, -0.04065864225673952,
    #                                -0.061303443125639005, 0.45273679880549966, -0.13627828699606231, 0.6534275836614664,
    #                                -0.5396565985974825, -0.15034221490964175, -0.15398506812364732, 0.7588554039000994],
    #                               [-0.48895273432519915, 0.344937003294322, 0.3368637161275571, -0.3746139226197779,
    #                                0.24045214836944498, 1.3755960242758587, 0.03240153909386928, -0.11346073435361137,
    #                                -0.29202417320610086, 0.2744319677471327, -0.24588282273273906, 0.3347638220406257,
    #                                0.43808970527709584, -0.22485953112289847, -0.46444660725316034,
    #                                -0.27732892842209156, -0.025588453558935943, -0.08207301670359703,
    #                                -0.40751687061846115, 0.06154221877540943, 0.20846518209596132, 0.43054337105715906,
    #                                -0.07878961204571021, -0.06641781666793697, 0.28182815857817173, 0.8243462381531569,
    #                                0.2687458416257742, 0.27791795943825076, 0.2548526471173769, -0.2618777781968554,
    #                                0.5645519236198078, -0.21737200555074973, -0.03942439438982699, -0.3411796916207459,
    #                                0.3145035245115681, -0.21945158150586871],
    #                               [0.493335275249706, 0.9863451172073218, 0.928558254853148, 0.6343842310146081,
    #                                0.7030333159920171, 0.8685485180457334, 0.9505229969509296, 1.1002828106486835,
    #                                0.7286696486528116, 0.185022153764385, 0.47632606042318276, 1.004398973684181,
    #                                0.6687271904939738, 1.0073822273110453, 0.1236794556429635, 0.12299701549637192,
    #                                0.661552593259995, 0.8763600099016873, 0.3915091764786917, 0.6679152553285436,
    #                                0.7953094894736119, 1.1636915958380853, 0.5949662414194933, 1.0663682720597127,
    #                                1.0650411461427018, 0.044664930640816704, 1.050953087393374, 1.0977558834130712,
    #                                0.4289676654220419, 0.7918656685554772, 0.9114098366337582, 0.44747729211732734,
    #                                0.27510793355389834, 0.9290777649956582, 0.2582623927054335, 0.5857156029493474],
    #                               [0.23008363387803502, 1.4001692102493737, 0.45251191758025683, 0.43337416013575153,
    #                                -0.03461992523109945, -0.09113037955345524, -0.11509206825025366,
    #                                0.18007286936972236, -0.36450735069135465, -0.3561575113335424, -0.5400598009776306,
    #                                -0.04156942471267377, -0.01837007748544584, 0.3013201584746942, 0.47395231571877644,
    #                                -0.19572487405404115, 0.7113425445969866, -0.18723861829235364, -0.03336193585145905,
    #                                0.3193606855589151, -0.39824046404855246, 1.189764481268016, 0.5697910377306346,
    #                                -0.233779388163568, -0.2816662628040113, -0.5276887070406684, 1.336926409224965,
    #                                -0.4782887029917425, 0.4177647280821133, 0.35393921414295504, 0.17271177232453003,
    #                                0.3205008884373187, 0.07579563689459969, -0.38045938520447903, 0.6406085737168196,
    #                                -0.9147257237490704],
    #                               [0.14706312519199313, 0.6560263675745758, 0.38922594966779844, 0.05025157034694876,
    #                                0.5902229078676388, -0.5687126225107385, 0.2839641124402457, 0.33760434482141743,
    #                                0.5080395899577188, 0.28869762717476716, 0.0164416697482649, 0.6070235304260272,
    #                                0.03048691936838567, -0.3119812602170484, -0.006253008745840076, 0.0661346906175511,
    #                                0.9696022662953228, 0.6754215568213761, 0.050475927993615194, -0.08224396785634826,
    #                                -0.004862541584757333, 1.040982788518314, 0.16357685623927337, 0.27722661514645336,
    #                                0.6050200425107527, -0.43769520143627694, 0.6747827261099537, 0.06054531207254403,
    #                                0.5230016643594999, 0.5568181256011859, -0.26280666928974616, 1.4190897618349103,
    #                                0.3694444327144781, -0.3961454685121237, 0.10973002097983346, 0.14225512503198542],
    #                               [0.569795870134965, 0.06542651021987783, 0.37275380211502485, 0.3343931136805795,
    #                                0.7637271013097294, 0.5393050728030652, 1.0200672132789932, 0.8492684511810187,
    #                                0.21339012787364495, 1.063310457890725, 0.9831970246715274, 0.991572170222794,
    #                                0.5770799101286495, 1.196337008829399, 0.12692011726522354, 0.24987707892090627,
    #                                1.0241950681683638, 0.7557194630696719, 0.6714367180432576, 0.9621376468597663,
    #                                0.5682218219352846, 0.8640889420742871, 0.6162412406925136, 0.7173230927000577,
    #                                0.6160479080374704, 0.20083054619106813, 0.4494002677453127, 0.9945567968824355,
    #                                1.1031807244323337, 0.8370251850902101, 0.9836033783350037, 0.9481732564984652,
    #                                0.4165827018024714, 0.6573175907595185, 0.25791807465086997, 1.0300932058158634],
    #                               [-0.028016575173105886, 0.12799741388415783, 0.4241507066562308, 0.192051169215611,
    #                                -0.30292120475643547, -0.027760613680145933, 0.13933166443047637, 0.7969466333675879,
    #                                0.15383550746941516, 0.22647819957016976, 0.5269461950601944, 0.32882059859664176,
    #                                0.48658782511040094, 0.3577698754569811, 0.1401645999173431, 0.505657017901504,
    #                                0.4657909035473284, 0.886088863927383, -0.26295959876128566, -0.16585190471195113,
    #                                0.6273027876374218, 0.691198602112563, 0.42747674330718033, 0.76814474350482,
    #                                -0.2096057948252435, 0.7186170848438237, 0.35948059208850036, 0.28628215767505344,
    #                                0.5650601607431807, 0.5851831865225058, 0.3891991654811874, 0.5092933456786681,
    #                                0.7414100635699022, 0.2685015394359305, -0.0816203469399204, 0.5465397825959556],
    #                               [-0.2413091782103484, -0.33149076207940115, 0.5637985504915869, 0.9740617665732503,
    #                                0.3799567801156411, 0.985144552951752, -0.3592178691035273, 0.9565741015789513,
    #                                0.24125102362835296, 0.7650745459808849, 0.21421656291171426, -0.15052485910815724,
    #                                0.24186188262847383, 0.2496834225232291, -0.2599830766455022, 0.26757447949186874,
    #                                0.04351103299024794, 0.31902913196488647, 0.7197762359205406, 0.3450876951196739,
    #                                -0.2308794598062347, -0.9696025494030459, -0.02510167415763731, 0.016944144517306817,
    #                                0.19964600811711256, -0.14646148902135225, -0.9994820565521156, 0.5955907716220761,
    #                                0.3481785277880728, 0.43227799099458153, -0.006187291981000102, -0.8557942231362543,
    #                                0.5859994669793013, 1.2272385730145388, 0.6881722624958444, 0.1774471606593083],
    #                               [0.12638258792899487, 0.036155208736055024, 0.14284631603470166, -0.2212163448680179,
    #                                -0.010251038807429027, 2.072410290250249, 0.16572733846438648, -0.4169879130784525,
    #                                0.06697369281827799, 0.08935366331349519, -0.09521919281375262, -0.3673836489494543,
    #                                0.013285473497765989, -0.22816953715133828, 0.24331682358464188, 0.4308385331764051,
    #                                -0.28110563093872354, 0.3528898030061562, -0.14928829327379334, 0.11113813987033946,
    #                                -0.2347206875176876, -0.17731649298378305, -0.48282884363616607, 0.4205604095572378,
    #                                0.38699421909742177, 0.12967653276830965, -0.7259816070320465, 0.6039951877173246,
    #                                -0.2911035774557533, 0.4756400313751176, 0.1345477833999249, -0.19455591393399196,
    #                                -0.0842929066800061, -0.11666710299013128, -0.3005189220953291, 0.3004155369547394],
    #                               [0.24620160410112502, 0.8545860222090718, 0.6405442316839843, -0.033403807227748994,
    #                                0.5109934247545439, -0.19094481076494085, 1.0899221472447869, 0.14527151927090554,
    #                                -0.039483145214661466, 0.2687635798923277, 0.3884348718682488, 0.7916585512417129,
    #                                0.10520409457841642, 0.09046114374900037, 0.29245885246588255, 0.5299377370705569,
    #                                0.054338084293234126, 0.6387215716235815, 0.04257087299252261, 0.8028706008005242,
    #                                1.0628159229508838, 1.1182734506937164, -0.19273713395326172, 0.5911286123697038,
    #                                0.5183858567456625, -0.06627244683507984, 1.148601268330039, 0.45328234061185785,
    #                                0.504740835451414, 1.0338317298484032, 0.25689970264851325, 0.9680714193017548,
    #                                0.41900983219376065, 0.22903786249149483, 0.16128569137413953, -0.16890854604279484],
    #                               [0.41697377900348415, 0.023460137077384275, 0.41016421875085424, 0.54891794508068,
    #                                0.4506986363014261, 0.3617878490406705, 0.2209602334925572, 0.6304641143191345,
    #                                -0.010367501262698023, 0.1814415219632754, 0.4979146404947331, 0.11755092918654936,
    #                                0.06581938791526581, 0.10312589731544532, 0.6701502110289088, 0.28130892879330494,
    #                                0.5906641744619816, 0.3856190432002853, 0.009746867330770176, -0.044339846190068546,
    #                                0.3086366288669588, 0.26658511429235426, -0.07951388514534581, 0.21258464518592224,
    #                                0.24705182327975075, 0.04889532076126619, 0.03305800312092662, -0.06279508752926169,
    #                                -0.028500801310466967, 0.017309391393410558, -0.01546009245216155,
    #                                -0.25311068799228353, 0.5111195056932455, 0.6237164115450848, 0.2634762232874045,
    #                                0.4818223657908299],
    #                               [-0.4077670707480009, 0.43186942940241524, 0.19971692200559116, -0.21189948003632034,
    #                                -0.16885003331373394, -0.1718087274089312, 0.37809802865303405, 0.14115965350421522,
    #                                0.695069832060255, -0.1144016641599283, -0.7311874790188123, 0.23764347707218889,
    #                                0.16996109565557943, -0.2045008744884589, 0.17589808206980984, 0.23245890423991833,
    #                                0.22797102456017468, -0.28914452033785976, -0.22318699597455857, 0.06289621718260437,
    #                                0.6191120506934338, 0.48619221069714025, -0.03808698091438967, -0.2324718117408594,
    #                                -0.32275038504766745, -0.12364562884676439, 0.7907593429526061, -0.18045397909025626,
    #                                -0.1445234852976342, 0.5099655700462177, -0.22055178502584535, 0.7014448062369345,
    #                                0.117011615709401, 0.4290972220144685, 0.5504986557847581, 0.4311408321871461],
    #                               [0.9018597918887088, 0.7219418077569679, 0.42169180806925843, 1.0725525692743743,
    #                                0.29578666959308203, 0.5438721600211861, 0.4621835903748558, 0.44232752062235575,
    #                                1.1662423172377403, 0.8345304766911071, 0.35174481196545704, 0.8926965266702097,
    #                                0.8902083760930235, 1.0673232184143735, 0.33656407861488524, 0.35317953196061935,
    #                                0.919418138402898, 0.876596997103157, 0.921537511142861, 1.0573208472245645,
    #                                1.033057494854586, 1.1173802786260252, 0.37462647574679686, 0.49165205303734527,
    #                                1.0629191350750118, 0.6314857925695613, 0.9005127789207427, 0.5483461527394263,
    #                                0.6077092576135613, 0.6386459802496328, 0.8109491553806731, 0.6508253821267772,
    #                                0.7990569568815967, 0.9198127378188682, 0.24955811902830555, 0.9303723951052073],
    #                               [-0.5604365982358023, 0.24688710326940033, -0.19306726904703253, 0.6291862730918751,
    #                                0.29249911562645214, 1.7773146408127243, -0.16771306034636668, -0.06915739895101469,
    #                                0.5130570171638135, -0.1660473487570592, 0.6608311763463631, -0.14734937169722231,
    #                                0.5703383235398183, -0.057041930719978075, -0.6717092983876275, 0.6758214626447796,
    #                                0.015562129620840696, 0.21745142444699825, 0.5662808275675856, -0.42651307821501766,
    #                                -0.6443091495811463, -0.2276262159757588, 0.2262122339034335, 0.4376376357803693,
    #                                0.4525124781644043, -0.02429794402457919, -0.9957247617984112, 0.4009771088575595,
    #                                -0.2586779737194159, 0.09582740455632921, -0.3255297616937555, -0.2616687562119516,
    #                                0.08321558362052232, 0.18747847689127337, -0.39444532362553164,
    #                                -0.01799673784193582],
    #                               [-0.45151170789443656, 0.6805769534300891, 0.18869653141887763, 0.5190587246126815,
    #                                0.22064628762907026, -0.032112275923083036, -0.08462503509465111, 0.1100177063205068,
    #                                0.33339892631118534, -0.6162542846814616, -0.05432166479944421, 0.6847447625047454,
    #                                -0.36689588887879065, 0.28139199858602065, -0.26163934557087326, 0.13072011469338524,
    #                                0.7130102818662754, -0.2064023869113448, -0.26014411438897816, 0.3151283673354809,
    #                                -0.6734663165598573, 0.5254987554644797, 0.1612305559433887, 0.40141548463009546,
    #                                -0.7158688560190413, 0.284855763145258, 0.45166742339004196, -0.3868803408316339,
    #                                0.8165710355406557, 0.21517238180686174, -0.05339705976878378, 1.0096388899323008,
    #                                -0.39932975585960956, -0.547499905437935, -0.07838302707869928, 0.01745601821729877],
    #                               [0.6171952748522114, 0.21252124099049657, 0.8487833023537416, 0.8024590068773519,
    #                                0.7511553103403129, 1.5339419993205081, 0.20490317137253916, 0.7263228889872103,
    #                                1.3188743133929373, 1.736216613797392, 1.102447780666184, -0.14623545404032032,
    #                                0.557922472242241, 0.06876244718880586, 0.1327128526047609, 0.0025443683060124116,
    #                                -0.048057126593631885, 0.6065797135545338, -0.03520109253003315, 0.42527626200194274,
    #                                -0.5314435091009139, -0.22097778545283447, 0.415606487875682, 0.8788697058768224,
    #                                0.5802038679246022, -0.8600547292713524, -0.484837634733597, 0.7035887453930583,
    #                                0.8159333608185927, 0.7409620523424109, -0.4060158341694594, -0.7137679542635991,
    #                                0.8290309712284509, 1.4158868862354186, 0.8342466637342406, -0.6652331097700274],
    #                               [-0.0430740647944684, 0.9186130968447664, 0.9532976537620051, 0.3595305831275695,
    #                                0.8737523230893011, 0.10875613730701966, 0.27280403301264883, 0.4115484002192572,
    #                                0.7502059764844652, 1.1926485609815627, 0.7676495590282141, 0.5632345988413867,
    #                                0.946260239831327, 0.7173967755762004, 0.7219460208955136, 0.8678082854283703,
    #                                0.7495569375138129, -0.03561176247936631, 0.06150840635961898, 0.8533226902839343,
    #                                0.23005836447954697, 0.6474526644793541, 1.1723993151270806, 0.4984917395420666,
    #                                0.5291816363624775, -0.017685095512976638, 0.7363926109477299, 0.9400615623288932,
    #                                -0.15136326496144323, 0.8021233408297314, 1.055072230086712, 0.8527608274057431,
    #                                0.01004051975840804, -0.01767927670368938, 0.6422222365267607, 0.27262018967360624],
    #                               [0.375671424117695, 0.3153008294415906, 0.8093876281432638, 0.5684404107834158,
    #                                1.240521149454682, 0.6033941826757293, 0.31915530917772583, 0.4822030247942952,
    #                                0.21499165624434205, 0.4144208657401157, 0.17832830564497001, 0.2700823779171048,
    #                                1.016579034475211, 1.1534082223982327, 1.0072765788311615, 0.6363692354321141,
    #                                0.3061320060637656, 0.6628705184495115, 0.20197896788325162, 0.6090010376555423,
    #                                0.8386939429796606, 0.07536936529531621, 0.9371761393175613, 1.0488655881689462,
    #                                0.2138771237653588, 0.041424263797215685, 0.8366082832035306, 0.45606951187093053,
    #                                0.633186597922353, 0.8442559127281123, 0.4655064449370087, 1.0831663888918988,
    #                                0.06167550011031946, 0.3450912075609739, 0.496196671731625, 0.2499635799571208],
    #                               [-0.8522138127731621, 0.3655012170020723, -0.008231199437748958, 0.039603530296356215,
    #                                -0.060831224499193065, 2.0182509392632277, -0.06846441990454843, 0.9155857377907148,
    #                                -0.23671481269589909, -0.4255899781849998, 0.8182804884556252, -0.6075114159746194,
    #                                -0.046780617989806664, -0.12958434714085684, 0.0700590563294029, 0.37241478655635857,
    #                                -0.024258413504641283, 0.05803086894463136, -0.1366876286155814, 0.2972806668446707,
    #                                -0.041811736710384156, 0.2601652791045533, -0.07409256256608825, -0.3174644431021013,
    #                                -0.21271241667494808, 0.32552534253538773, 0.11293535510047456, -0.352192164309045,
    #                                -0.09730849161322692, 0.057716046660656266, 0.3454768546658387, -0.6981209065050819,
    #                                0.7891405461354073, 0.10197494537546384, 0.29638181049093704, -0.08096610943728524],
    #                               [-0.2254511612002236, -0.4009199198008066, 0.11743137106686491, 0.11742228805926018,
    #                                0.8251554798042876, 1.4707379074449605, -0.20450635337601908, 1.058959964478848,
    #                                0.5179034880416353, 1.1418147472092202, 0.4961966102570139, 0.3777996833368441,
    #                                0.1651037749463674, 0.19411585411613838, 0.29290612108361497, 0.587679936946633,
    #                                -0.04694202969199445, 0.2711027589947276, 0.3073891311464674, 0.18739471382241107,
    #                                0.3188836741772071, -0.09111251202236388, 0.045655747307759176, 0.5237005423995733,
    #                                1.5628675745599145, -0.47620396593939573, -0.7429763068023814, 1.067165866747462,
    #                                0.8510049461741601, 0.7039590808069662, -0.3164855348410342, -0.2691378772871022,
    #                                1.8446026550997652, 0.9560697914573322, 1.1835965117484686, -0.7267245114532416],
    #                               [0.7408006999076049, 0.23225890922006917, 0.4080862673888547, 0.7802855896404837,
    #                                0.27631615906193696, 0.4048658406560222, 1.1475354755656497, 0.49095983740286014,
    #                                0.782369602360284, 1.0760880611074426, 0.5065464776859052, 0.5230293364321101,
    #                                1.0194619714462676, 1.2023347863322444, 0.8753728247438775, 0.80696111356669,
    #                                0.2566325070772947, 0.5239551699069436, 0.7538826966528187, 0.6918464618537948,
    #                                0.19166028333230187, 0.5329522069786818, 0.7408799211122833, 0.5979599258558596,
    #                                0.8318798589006938, 0.21916578573852893, 1.0067253794896067, 0.793970019669846,
    #                                0.8058668217606519, 0.40341436417334564, 0.9152560002653377, 0.897754464294518,
    #                                1.059112758111357, 0.7585216913258667, 0.9381645031199556, 0.6567524576899487],
    #                               [-0.04983248805909735, 0.8606127797425298, 0.48887684633477435, -0.23197068547382116,
    #                                0.30986625291742814, 0.1735652544197412, 0.6353653040731728, -0.1623461149464455,
    #                                -0.08827700702415821, -0.04850525224934847, 0.7917816779901328, -0.1669307071198244,
    #                                0.0791741641687882, -0.23763153004539073, 0.6773242182670499, -0.541897427739624,
    #                                -0.1981060307820756, 0.14570287131977072, 0.17054683461133308, 0.10350901962397809,
    #                                0.03242574938240593, -0.31941224141162017, 0.5140660799283794, -0.07471309484235103,
    #                                -0.47981268663016385, 0.14709916259453093, 0.08642799591210776, 0.10481545157267796,
    #                                0.06513699208162005, -0.28482519175861687, 0.32357214093858305,
    #                                -0.005744649126001264, 0.19040210963050638, 0.144651389657335, 0.08187459229139886,
    #                                0.38997601528467457]], [
    #                                  [-0.3865634393581626, 0.4483112908609338, -0.12255546221578546,
    #                                   0.19456757842181352, 0.6675902399629938, 0.7206156120409172, -0.06968540932620802,
    #                                   0.49649389713064124, 0.4736408671947431, -0.27162322356381413, 0.506902999128123,
    #                                   -0.011809763103230203, 0.3828856362052133, 0.13441601190728558,
    #                                   0.1906618879428336, 0.22271002590517797, -0.35287337826798393,
    #                                   0.14758538428605567, 0.5855613179731582, -0.4841761271456486, -0.2744838691733496,
    #                                   -0.1505533378364146, 0.3721962238081001, -0.31909611049337955,
    #                                   -0.27329602373849143, 0.5736167513482275],
    #                                  [0.39623996023167385, -0.17492339807617108, 0.4492996796772862,
    #                                   0.44106916944537766, 0.1351550008034604, 0.8000982794806633, -0.24419516653006879,
    #                                   -0.11531581954780777, -0.3117657308163306, -0.16298321117453657,
    #                                   -0.22850544822098168, 0.8286518601447664, 0.8298291887853295, -0.2349651787768063,
    #                                   0.18895715115198694, 0.05051308397833923, -0.4902850203298927, 0.569462206035234,
    #                                   0.16444257421324837, 0.6828030110022696, -0.04558714273883316,
    #                                   -0.38924250327891724, 0.6922825987683549, 0.29973103713814886,
    #                                   -0.2432601956571366, 0.4711838187275879]],
    #                              [[0.4038204862347349, 0.5523322863408449, 0.48477031841940726],
    #                               [0.034564474782451476, 0.8442336523036145, 0.06417324722406273],
    #                               [0.4910727383655155, 0.09705011025941093, 0.5361830791574362],
    #                               [0.1590227490028375, 0.207572629509971, -0.31166889773234974],
    #                               [0.22073979878854472, 0.5972934160919282, 0.24899121068606817],
    #                               [0.5365288712726672, 0.5974089214365856, 0.13796566003577856],
    #                               [0.10177705620200414, 0.43719514574985074, -0.05214121863757089],
    #                               [0.3412008527575286, 0.5234455499164574, 0.45440802569089145],
    #                               [0.12278306279277357, -0.1438712065343927, 1.0708629405231884],
    #                               [0.20224106610550982, 0.0763169296982744, -0.1861425274905366],
    #                               [0.33203060987995336, 0.5454407346166369, -0.40339294319474134],
    #                               [-0.11377856256296498, 0.2103745055896262, 0.8181784406627125],
    #                               [0.2091303228759031, -0.27376883701475174, 0.1177823643944582],
    #                               [0.6473893451683822, 0.12663657365882325, 0.7881114355407043],
    #                               [0.11008959762495973, 0.4113663939967996, 0.36761707603797616],
    #                               [0.14736858576057213, 0.8418210156471818, -0.1340674667168349],
    #                               [0.17273341549692972, 0.2620097811296949, 0.5267655502620766],
    #                               [0.2945785468236605, 0.08210700437451186, 0.5616740874476435],
    #                               [0.6063639423648148, 0.5590626265308434, -0.14533585667211035],
    #                               [0.3265724300251039, -0.18431402226476634, 0.42440386630402316],
    #                               [0.6020571771621166, 0.2398062090915324, -0.2524535192535011],
    #                               [0.4720866405674612, 0.3044203714107597, 0.7465810702798208],
    #                               [0.182054644639708, -0.15825881266352376, -0.07895977815721193],
    #                               [0.3840029383335963, 0.5674201438376489, -0.1471637490802133],
    #                               [0.1610186181694937, -0.05410774716539507, -0.023285335319248205]], [
    #                                  [0.02758646842658988, -0.2741627127846612, 0.47773056062839947,
    #                                   -0.28377397740689403, 0.11542152323188797, 0.09698221320493124,
    #                                   0.4226794150689043, -0.10542882588256698, 0.020656706406350252,
    #                                   -0.4440433471701329, 0.5294087020250531, -0.16998677890448943, 0.5954124526382018,
    #                                   -0.4379226757044123, 0.4718035450088526, -0.20050438521231845,
    #                                   0.21053955200694707, 0.24869957946891832, 0.38858654115521374,
    #                                   0.43603646596968165, -0.4646039430429822, 0.4760258798350354, 0.3396020462313433,
    #                                   -0.20917320782027068, -0.055236437175284134, -0.25796436238149584],
    #                                  [-0.0778327097766441, 0.3318461842672224, -0.44946631777226725,
    #                                   0.17596115453052663, 0.5249828067599829, -0.29331027693730477,
    #                                   0.30306676098013063, -0.11017778337606451, 0.002982097792592885,
    #                                   0.7083788034233942, -0.22693121658856524, 0.28505785993327626,
    #                                   -0.12836241322715097, 0.6490887842661466, 0.06819297797136216,
    #                                   0.19946407558012375, 0.036165234484528394, -0.05017243395622313,
    #                                   -0.17457032095727365, 0.3744793882873139, 0.07917217418232161,
    #                                   -0.3135459462828888, 0.366023904532276, 0.06542438661980429, -0.0471730084151117,
    #                                   0.7462641399567748],
    #                                  [-0.02528535389726127, 0.24486692829951048, -0.5592458658774409,
    #                                   0.07337319058977697, -0.2937240204128111, 0.005077499077723221,
    #                                   -0.19915921643283396, -0.3727494794562041, 0.4776438307533405,
    #                                   0.26985373708954663, 0.029391325224579934, -0.09766484487161962,
    #                                   -0.7849850544494383, 0.6040365143565062, 0.41004185244996694, -0.5383622128348439,
    #                                   0.0847619278162017, 0.33085204492673803, 0.21905858277106133, 0.3892340043784871,
    #                                   0.7422612528081912, 0.046763965159431056, -0.16701537220657922,
    #                                   -0.1114104115523027, 0.03808311867906751, -0.016769775110249414],
    #                                  [0.3285817480366804, -0.3044263099525113, 0.17071657651838987,
    #                                   -0.12496348904049125, -0.27678574915214627, 0.058044644191976184,
    #                                   -0.41625807753989513, 0.1513786397096783, 0.23785993455076157, 0.3437474843644055,
    #                                   -0.11638293374735956, 0.2084769986338271, 0.5630666761974679, 0.29626779752410215,
    #                                   -0.2082645882657426, 0.6619303471282367, -0.2393834038223918, 0.569719602351661,
    #                                   -0.252008725065943, -0.2350346580452903, 0.4349319896585363, 0.2007147978315639,
    #                                   0.26454108558590195, 0.03710243873442635, 0.5366776290858818,
    #                                   0.39679033888152315],
    #                                  [-0.07072807981125648, 0.03932404443959357, 0.5686204228764589,
    #                                   0.30790487369912595, -0.30660166145894396, 0.14185032635758602,
    #                                   0.2251454588057102, 0.13582617555051157, 0.2024626040228306, 0.1002587885147009,
    #                                   -0.0425638854625917, 0.08866073250196968, 0.4197491910247322,
    #                                   -0.15242737877088602, 0.43042430287239003, -0.3045621818699029,
    #                                   -0.10059465408896796, 0.7084374333781551, 0.3896429720596612,
    #                                   -0.07996902446695844, -0.1114815107745655, -0.153296165864596,
    #                                   -0.27552508606935083, 0.4603135063190033, 0.3172554686428575,
    #                                   -0.008464883172301577],
    #                                  [0.38999998820329973, 0.30515427690561003, 0.5710157691804312,
    #                                   -0.07176394731004791, 0.02480716047756998, -0.222362083161989,
    #                                   0.13279955716964523, 0.06056837050972653, -0.02968197988814739,
    #                                   -0.4353912379144115, 0.11903599716561095, -0.12276094129358871,
    #                                   -0.078304418494763, -0.21172372942318363, 0.05631305173128213,
    #                                   0.12474398768106251, 0.1935913717970811, 0.6748558804525425, 0.45874183627599496,
    #                                   0.08647938051221268, -0.04062174003384375, -0.3131365708650025,
    #                                   0.059979659614428624, 0.32996848086452607, 0.5428179639083518,
    #                                   -0.09559883578802293],
    #                                  [-0.061425229108985485, -0.1538917221897622, 0.4015491498671174,
    #                                   0.43910710054182084, 0.6200551969207729, -0.24056139580447455,
    #                                   0.35689429407433154, -0.07447186858995822, -0.020448581405301976,
    #                                   0.41612702737938057, -0.016212523707616174, 0.2859702149816865,
    #                                   0.36689848880610637, 0.3832604508346277, 0.5366564667664755, 0.17165829797902665,
    #                                   -0.030944468290244023, -0.06266780219942936, 0.5877850675486005,
    #                                   0.026596597796973914, 0.0420068089082127, -0.06842984273843736,
    #                                   -0.10745069815874903, -0.08982593587441662, 0.1368411859696714,
    #                                   0.5580040815863074],
    #                                  [0.3402009132620399, 0.1233003397760037, 0.04908396419801554, 0.22408732295851577,
    #                                   0.2790790694164712, -0.1635753402952323, -0.3077201247156551, 0.15483434618888067,
    #                                   0.45294119577492636, 0.3809056434613899, 0.4976444539103018, -0.13624923357790145,
    #                                   0.3284605539852602, 0.6144719641749182, 0.016895009317680874, 0.05718651654343867,
    #                                   -0.6171291054217685, -0.07105468610891501, -0.33319803904791667,
    #                                   -0.13093723038222174, -0.009741678886320262, 0.5002632085370408,
    #                                   -0.1777545983255464, 0.8575279317018202, -0.07455639542257927, 0.213510387259853],
    #                                  [0.2420150813751186, 0.446520163856693, 0.3247364144723315, 0.4326327713526708,
    #                                   0.1250362008150587, -0.10854360528613866, -0.366807064615749, 0.41850613923368163,
    #                                   -0.21814339837061109, 0.07681588945728524, 0.3235497554167287,
    #                                   -0.3021353947060513, 0.9200650991599912, -0.4288101934465091, 0.1543592566661146,
    #                                   0.09599898226518437, 0.15772951539751454, 0.06664004546297798, 0.5267649170431058,
    #                                   0.3011177240371154, 0.2147958965522952, -0.41313264450841386, 0.2751327723676905,
    #                                   0.42685348294584413, 0.13531780525294712, -0.4399547182205432],
    #                                  [0.09971719822417272, -0.28047194997955716, 0.21462811017871813,
    #                                   0.056473368322711597, 0.008650702994569425, 0.47053164562636873,
    #                                   0.10158610274532955, -0.06556049989450353, 0.36613237625329403,
    #                                   0.5434869093383192, 0.38017566678570974, 0.008567948054312892, 0.4869627342159993,
    #                                   0.5008431277972802, 0.5726679497512375, 0.18442005560754804, 0.4255544507465157,
    #                                   0.3487447639085482, 0.5472111088804988, 0.3385875493514471, 0.31753074313440166,
    #                                   -0.6384933363673151, 0.1635241566469588, 0.1786406911725509, -0.20521486959809915,
    #                                   0.6266758849259318],
    #                                  [0.2398780594945404, 0.7541592374762235, 0.8857776348552862, 0.43386980799677616,
    #                                   0.2247679456730094, 0.3922593947009239, 0.5869129765710236, 0.7502460460156264,
    #                                   0.14558963555942694, 0.2271549460026471, 0.646023242736673, 0.4633087359813384,
    #                                   -0.4896359699090794, 0.014715127244640854, 0.05349721885685035,
    #                                   -0.23245206786915915, 0.6502221451462333, -0.039291245165962094,
    #                                   -0.13904095720004087, 0.4410008983279284, 0.24107191266047, 0.4377454361220848,
    #                                   -0.0810358215468312, 0.2084799510729009, 0.8930796372471925, 0.03583989437612096],
    #                                  [0.04647888696198342, 0.6440567226050123, -0.01690708240132339,
    #                                   -0.10627184295151927, -0.44468915125735536, 0.44703028276204226,
    #                                   0.42544796024242587, 0.07182175715267915, 0.09521736715585832,
    #                                   0.11176896272860479, 0.3922970292693847, -0.26343092876611607,
    #                                   0.24800768411868027, -0.14585793575987666, 0.6854082878957779, 0.3563232641021684,
    #                                   -0.17875440535496226, 0.6186468280111498, -0.03083165656814056,
    #                                   -0.2944515787186142, 0.5287986755455086, 0.5556425446508593, 0.23970673371776702,
    #                                   0.6436957705065578, 0.27329061769303215, -0.057763891119007975],
    #                                  [0.4148581803052067, 0.3227137642846391, -0.2635679373068183, 0.23400469058005988,
    #                                   -0.03409067324340071, -0.093055503488121, -0.15735812211069125,
    #                                   0.5071843415196423, 0.02419259552034082, 0.05189245782532555, 0.42857144090695953,
    #                                   0.27565897500197517, -0.017756112152817832, 0.5312476086264529,
    #                                   0.18455749392597448, 0.08498797033771797, 0.5779475371603796, -0.3567644332035118,
    #                                   0.373930924274455, -0.32137626121628665, 0.3952914440048388, -0.2739557254350604,
    #                                   -0.33189789604401765, 0.27699872444989027, 0.38695151881928413,
    #                                   0.19597907672660658],
    #                                  [0.41331407609188897, -0.24991921925405713, -0.013021177091384459,
    #                                   0.3423197698559053, 0.4929283731500107, 0.5316968972072235, -0.16646387778541483,
    #                                   0.23551651146945318, -0.1816973457598957, -0.24750963521688538,
    #                                   0.4041876071481308, 0.7714467603663936, -0.3750921258212775, 0.09445010730958667,
    #                                   -0.09232461807394447, -0.14787047690564606, -0.3501684295700295,
    #                                   0.40935181149863537, 0.23163913255548713, 0.568087088343777, 0.1437922271693237,
    #                                   0.3412012349285225, 0.04551654435461005, 0.4844288086712521, 0.384784273805833,
    #                                   -0.0657054968897791],
    #                                  [0.07358439894307871, 0.5444338902569779, 0.11279669458045534, 0.253949231381718,
    #                                   0.023956761686763615, 0.4392644203776335, 0.21334676009772585,
    #                                   0.19079177333324093, 0.6208302968583337, 0.8789111784087916, 0.33727576396015235,
    #                                   0.01858158666828351, 0.8396209722549254, 0.17534960922134504, 0.5327546449311196,
    #                                   0.8610788578977515, 0.5840368902003719, 0.6894316509090589, 0.25429659403764093,
    #                                   -0.019433454070561625, 0.5318836031370071, 0.48560263857082797,
    #                                   0.3709567608336859, 0.20810538447204638, 0.16429673804993558, 0.3240011091584131],
    #                                  [0.3263638456895442, 0.36803095749051634, 0.7337578327956986, -0.10669360823476963,
    #                                   0.7083865533381752, 0.33296275383049584, 0.6571818270855514, 0.9146566342259268,
    #                                   0.3671186507287699, -0.6169163708125326, 0.9730737334542899, 0.20762798265128896,
    #                                   -0.5134691290103727, 0.24048177587814307, 0.5692197659926963,
    #                                   -0.27378283817670845, 1.0315938224067853, -0.3954784387762642,
    #                                   -0.1427266526781034, 0.4604767702179186, -0.13767763114290002,
    #                                   0.23609226475739042, 0.45177680272189946, 0.2804161626186909, 0.4252313746583734,
    #                                   -0.08541311937640349],
    #                                  [0.2409182510045266, 0.6159887559659545, 0.23558868940622824, 0.25693254748442046,
    #                                   0.07094428860867319, 0.22811168882595492, -0.17423060105583427,
    #                                   0.1747272846033399, 0.022958939622205528, 0.4729736376208881,
    #                                   -0.00701052144256418, -0.05485798673045642, 0.5267579291902696,
    #                                   0.5293191111401466, 0.7263831055259349, -0.10207124576081128, 0.359630461400286,
    #                                   0.13397416629568193, 0.036618733501720374, 0.22082159248026514,
    #                                   0.2535636630951837, 0.4885473748213696, 0.32114415380345, -0.025496438170413686,
    #                                   0.3135217279522878, 0.27891751996798897],
    #                                  [0.32278356987824963, 0.19093590779162478, 0.40013899313842993,
    #                                   0.16115427323330433, 0.4398059425812609, 0.6523671598168699, 0.07391308430862539,
    #                                   -0.017039590353315853, 0.49655068153498433, 0.44607308666440126,
    #                                   0.6914338114897085, 0.3232934104572132, 0.806555674010633, 0.3409362116370925,
    #                                   -0.3546051340492777, 0.8590608820611799, -0.04061462217265205, 0.5545116601108663,
    #                                   0.4045502392467545, 0.2012451554177316, -0.02102209180336628, 0.27588466599015565,
    #                                   0.564736026662563, 0.6081750954316538, -0.07185221432482643, 0.5526615179781188],
    #                                  [-0.25247272803524734, 0.518355288051059, -0.042579444993246084,
    #                                   0.4924902504670246, 0.22900186947002332, -0.21087963852425304,
    #                                   0.08781799630475637, -0.3660236435335894, 0.3338661008784881,
    #                                   0.053086722155887195, 0.33356181454495165, -0.09654416901115377,
    #                                   -0.2623119432996794, 0.5331025230327365, -0.15760717627556386, 0.1138056668730404,
    #                                   0.39253558461300164, 0.2568903735552683, 0.6639027136469972, 0.6213249957590925,
    #                                   0.12574699495502908, 0.5560526005636411, 0.39804715541034286,
    #                                   0.054651475389223964, -0.20283308376930173, 0.5688254590646501],
    #                                  [0.1381459216721504, 0.14313354320234437, 0.8402251128230043, 0.39185279508309345,
    #                                   0.64595648649866, 0.6973508104946866, 0.4572204584776276, -0.04238358860556073,
    #                                   0.6122146147945267, 0.39423537128241254, 0.3085580871152284, 0.7643591228066766,
    #                                   0.620399797897333, -0.250564355473374, 0.8261639259269994, 0.915041386884142,
    #                                   0.4908605379181268, 0.35737963995258415, 0.5355668978969121, 0.09164399569886839,
    #                                   0.3993860726580862, -0.10347147047830013, 0.8581122500651958, 0.26301765524007065,
    #                                   0.5767685861353719, -0.02539137449745438],
    #                                  [0.2546665686762045, 0.3510090685383967, 1.1231667774914813, 0.35055007851891284,
    #                                   1.0170309233386035, 0.5069335412247246, 0.25809181700401496, 0.46793149304624876,
    #                                   0.4126630524990136, -0.9762407290734552, 1.1353441564897937, 0.9510095406185419,
    #                                   0.03538567773577292, -0.15918393365465766, 0.21535851507105827,
    #                                   0.4738917721144772, 1.5261556402996657, 0.39097155279195445, 0.12976742886961365,
    #                                   0.5327650527171469, -0.04213027156981692, 0.6473756247368263, 0.14821595985421115,
    #                                   0.5471376675034538, 0.6564589718202672, 0.861816954093946],
    #                                  [0.2822054444550613, 0.33141514324233873, 0.5583425555101197, 0.02006898447912598,
    #                                   0.3920350754330796, -0.28221816501730007, 0.27236939279759775, 0.4615668689164157,
    #                                   0.1475477923715049, 0.5680403415421968, -0.10832144113000426,
    #                                   0.016200345718734535, 0.18895670026670805, 0.03345735156296021,
    #                                   0.1006049032310575, 0.24787575457604602, -0.07810698849484621,
    #                                   -0.0861295482062333, -0.13418280375501443, 0.13203980214467198,
    #                                   0.0019049714532659691, 0.0724143057345663, 0.46105183669152366,
    #                                   0.7652584125401989, 0.2640980872468465, 0.19246853205906622],
    #                                  [0.42244475810559146, 0.4985387754020279, 0.08317302931373322,
    #                                   -0.006828104464078258, 0.5042384173602809, -0.4194575446231617,
    #                                   0.2197495117938891, 0.17095083134283376, -0.04009902701001985, 0.4074002599033736,
    #                                   0.709626821353352, 0.2415759319919552, -0.20847098920198717, 0.749040061085358,
    #                                   -0.2848927802256328, -0.17105793790318427, -0.14171838322662195,
    #                                   0.4604732011936192, -0.1706015142101316, -0.1401470793261383, 0.4041427562009173,
    #                                   -0.27873123497224284, 0.23394789192645837, 0.21688914431390294,
    #                                   0.32698740813541244, 0.06923308671355337],
    #                                  [0.19798193210861004, 0.21612140652931436, 0.13388654341294884,
    #                                   -0.1274055540828789, 0.2951741690777672, 0.3244916071069079, 0.044258167165434195,
    #                                   0.28202260365494675, 0.06545023317962334, 0.4419212258754228, 0.280837231664115,
    #                                   -0.047013245292605324, 0.9924946247764721, 0.03267516687411898,
    #                                   0.22844937839825252, 0.2796081097108925, 0.08683832928768806, 0.12562905139307556,
    #                                   0.16822445450700277, 0.035032331522883764, 0.3129914768378564,
    #                                   0.06385970241047154, 0.3882649276490532, 0.6601305474014197, 0.048108574722828555,
    #                                   0.6010083157690116],
    #                                  [0.49640823215477137, 0.5411529835346144, 1.2284576815212371, 0.051826289081351104,
    #                                   0.4456370218175759, 0.8274686653485289, 0.5332536267283138, 0.2074436143228773,
    #                                   0.15373717964665765, 0.9012229626676134, 0.0485121871633429, 0.1959031018707231,
    #                                   0.987273300176719, -0.29748916552027144, 0.31355983201405246, 0.7698532618583349,
    #                                   1.3291217215303301, 0.8202428464919362, 0.716262559827709, -0.21051139283853965,
    #                                   -0.28314742447464664, 0.4077409149459202, 0.8538823645396119,
    #                                   -0.27486496888202605, 0.12495671537988039, 0.5051604067298734],
    #                                  [0.3160573284849051, 0.2615703461000007, 0.9516278251046635, 0.02229948597690041,
    #                                   0.9773055457331565, 0.3830718962420882, 0.2271574587451781, 0.4708937247803357,
    #                                   0.48921901943679996, -0.6500886861729696, 0.48238624703085764, 1.3906861689462524,
    #                                   -0.36843488607963343, 0.046670529941573044, 0.2725160826544318,
    #                                   0.8194156509083498, 1.2965156536329812, 0.3612243885176286, 0.08793521120731171,
    #                                   0.4567402579819035, 0.25419194631621533, 0.6889962996033547, 0.5995222729663479,
    #                                   -0.06970286321873807, 0.609019033110386, 0.15105441889364085],
    #                                  [-0.06000379822802638, 0.5805425354831848, -0.2636280827814577,
    #                                   0.19074511150018653, 0.03778932284277456, -0.002776800692645148,
    #                                   -0.13984612625345483, -0.09546130679917238, 0.4836451791526425,
    #                                   0.28305486082754916, 0.534252574782515, -0.213068165998407, 0.19000095362681912,
    #                                   0.02771080718597774, -0.06598939416787529, 0.3441753722032766,
    #                                   -0.43983929661475685, 0.03238813509369748, 0.7864372292409667,
    #                                   0.01495052611242286, 0.12666564320415036, 0.7675616078660156, 0.24084975710914489,
    #                                   0.762990404462743, 0.14309675521067977, -0.1810500162253202],
    #                                  [-0.12184199518128346, -0.277811939466224, -0.26929959520221913,
    #                                   0.12606803103449163, 0.13024720019772576, 0.4096787637209212,
    #                                   -0.027050807509131594, 0.09244295668951746, 0.39552615409282, 0.2532530588062307,
    #                                   0.5084626180516316, 0.38490572565154113, 0.08926274778090207, 0.4396568686670654,
    #                                   0.2944084774507634, 0.019445111716192523, -0.08540403386103364,
    #                                   -0.40776164247867325, -0.03729142664719327, -0.0329563292432858,
    #                                   -0.14695176760633194, 0.5442327282636236, 0.1309117050354173, 0.5434317548281511,
    #                                   0.38394329810142086, -0.1886994474972775],
    #                                  [0.06392567627046512, -0.0926401878697385, 0.2921816005950083,
    #                                   0.010383954299708629, 0.044850248467603854, -0.21371644658660827,
    #                                   -0.22951634976009244, 0.14043452294825257, 0.18979535044682638,
    #                                   0.5448569625368326, -0.29492131412616, 0.663997479549077, -0.07114112258896123,
    #                                   0.317208044044713, 0.045341622662442675, 0.22544446202294308, 0.16738122842847622,
    #                                   0.7553046782490594, -0.08246245173383229, 0.25545897389418476, 0.4256316141862494,
    #                                   0.6762618465421103, 0.3212738734629489, 0.2698658253373332, -0.1721134359699365,
    #                                   -0.22064193099792007],
    #                                  [-0.04002085655139373, 1.1195709566650414, 0.6155284054129054, 0.5464165575490715,
    #                                   -0.01259385677426752, 0.23846489876106558, 0.9281249562394291, 0.6501087129403306,
    #                                   1.0851390899573798, 0.7196971438373589, 0.08126192059414891,
    #                                   -0.019646802944579177, 0.5187435005266356, -0.15571787502065448,
    #                                   0.17310664046996757, 1.1272370466040482, 0.7581645041343541, 0.29680315073405145,
    #                                   0.29343359539662467, 0.5238394582448179, 0.4974481897335259, 0.3055816339057443,
    #                                   0.9086533155813428, 0.3145232394185223, 0.05021163713049028, 0.06907757481905126],
    #                                  [0.0648822380250161, 0.25797246090580617, -0.18204055250242715,
    #                                   0.23629675933197944, 0.8614123788022449, 0.5866774792498396, -0.08004779750868249,
    #                                   0.3895140757602565, 0.4075273376750736, -0.4084690117773265, 0.05207856046802284,
    #                                   0.7499028326021318, -0.3916716769165219, -0.22070255093491256,
    #                                   0.10359737587726832, 0.43068807135275683, 0.2537011369275859,
    #                                   -0.03735016537853898, -0.2234078016620733, 0.35488905726618813,
    #                                   -0.057743373081088685, 0.41605152118815, 0.10365364459528142, 0.7620887922882829,
    #                                   0.6944570545280208, -0.1113855315258768],
    #                                  [0.22573729381024743, 0.41163667473658794, 0.4736026250678135, 0.5735516415326749,
    #                                   -0.0206280604435337, 0.5926391796412953, 0.7194671951291195, 0.5173578936013449,
    #                                   0.6608581543399986, 1.156747870834323, -0.1364715505278207, -0.08322093091208015,
    #                                   0.6307133687017109, 0.5100011536540747, 0.6535807234760223, 0.4087135356170921,
    #                                   0.16983463964610054, 0.6321739116004019, 1.0713083889850454, 0.3001282978417867,
    #                                   0.8978669298481561, 0.02322298312838499, 0.6039121401049219, 0.20144605026521964,
    #                                   0.3262662170613318, 0.3881983938988425],
    #                                  [0.3262586327397458, 0.7519529982565003, -0.10609167036014991, 0.9826841071966018,
    #                                   -0.25557928097474414, 0.9547095762660756, 0.42785102091398486, -0.019438224059382,
    #                                   0.43685926509354034, 1.4931601131084336, 0.5272755888222035, 0.3752857365609236,
    #                                   0.7233596529436189, 1.102866944583987, 1.2871021789649992, 0.0019014818881081179,
    #                                   -0.35966826151314063, 1.196951901888352, 1.6892388080345684, 0.47279876669052423,
    #                                   0.9772628100864714, 0.19256722628381717, 1.2055742727960006, 0.3833348194503471,
    #                                   0.15014255375511543, 0.19528375565920325],
    #                                  [0.3823498616548119, 0.3654923024474735, 0.14732542746642258, 0.13478702537754053,
    #                                   -0.32957266749960584, 0.3159079698136555, 0.3174720064861937, 0.5612615452259561,
    #                                   0.11942216291576326, 0.9285546777206138, 0.3617073538604837, -0.07230116639294216,
    #                                   1.025424913294391, -0.040479113189320584, 0.48545443961789586, 0.3372556639295433,
    #                                   0.3814528963436792, 0.6170054466316025, 0.2916822580470872, 0.484665845814792,
    #                                   0.5742015479047595, 0.5169941331678021, 0.7328230043242718, 0.1807868080674787,
    #                                   -0.008157303763835817, 0.2353028593222253],
    #                                  [-0.006811554932033109, 0.026708483478370248, 0.6778872192935989,
    #                                   0.5326981385452222, 0.10096370755876378, 0.35972095429410095,
    #                                   -0.037425084822588085, 0.6721645565417835, -0.027374850620801014,
    #                                   0.14584725828043052, 0.30896474388783757, 0.4319123749776443, 0.8584379717943741,
    #                                   -0.28131016072719894, 0.8084184579431972, 0.2740994564952544, 0.26283594592093384,
    #                                   0.04583529425053681, 0.8340334493540801, 0.18408276462840506,
    #                                   -0.046272002007438036, 0.6597777639303083, 0.5039135541717592,
    #                                   -0.10827324882076791, 0.7527696482959016, -0.043137231630624155]]],
    #                             hyp_tan_theta, hyp_tan_prime_theta)
    print(n.forward_propagation(letters_pattern[1]))
    print(letters_pattern[1])
    (encoder, decoder) = n.get_decoder_encoder()
    test_network(letters_pattern, n)

    labels = ["`", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s",
              "t", "u", "v", "w", "x", "y", "z", "{", "|", "}", "~", "DEL"]
    x_component = []
    y_component = []

    for letter in letters_pattern:
        latent_cords = encoder.forward_propagation(letter)
        x_component.append(latent_cords[0])
        y_component.append(latent_cords[1])

    # Crear la gráfica
    plt.figure(figsize=(10, 6))
    plt.scatter(x_component, y_component)

    # Añadir etiquetas a cada punto
    for i in range(len(x_component)):
        plt.text(x_component[i], y_component[i], labels[i], fontsize=12, ha='right')

    # Añadir título y etiquetas de los ejes
    plt.title('Gráfico de Puntos con Etiquetas')
    plt.xlabel('Componente X')
    plt.ylabel('Componente Y')

    # Mostrar la gráfica
    plt.grid(True)
    plt.show()

    # print(network.get_weights())
    # print(pixel_error(network.forward_propagation(array[1]), array[1]))


if __name__ == '__main__':
    main()
