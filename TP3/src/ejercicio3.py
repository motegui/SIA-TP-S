from Neuron import *
from Layer import *
from theta_functions import *
from Network import *
from perceptron import multilayer_perceptron


def main():
    # excercise 3.a
    # layer1 = layer_n_neurons(2, hyp_tan_theta, hyp_tan_prime_theta)
    # layer2 = layer_n_neurons(1, hyp_tan_theta, hyp_tan_prime_theta)
    # network = Network([layer1, layer2])
    #
    # network.initialize(input_count=2)
    #
    # input_data = [[1, 1], [1, -1], [-1, 1], [-1, -1]]
    # output_data = [[-1], [1], [1], [-1]]
    # error = multilayer_perceptron(input_data, output_data, compute_error_multilayer, 90000, 0.1, network)
    #
    # print(error)
    #
    # print(network.forward_propagation([1, -1]))
    # print(network.forward_propagation([-1, -1]))
    # print(network.forward_propagation([-1, 1]))
    # print(network.forward_propagation([1, 1]))
    #
    # print(network)
    print('----------------------------------------------------')
    # excercise 3.c

    csv_file = '/Users/lucho/Desktop/Repos/SIA-TP-S/TP3/data/TP3-ej3-digitos.txt'
    clean_numbers = transform_csv_to_list(csv_file)
    expected_output = get_expected_output()

    # training

    # layer1 = layer_n_neurons(10, hyp_tan_theta, hyp_tan_prime_theta)
    # layer2 = layer_n_neurons(10, hyp_tan_theta, hyp_tan_prime_theta)
    # network = Network([layer1, layer2])
    # network.initialize(input_count=35)
    # input_data = get_clean_matrix(clean_numbers)
    # error = multilayer_perceptron(input_data, expected_output, compute_error_multilayer, 0, 0.1, network)
    # print(network.get_weights())
    # print(error)

    network = create_weighted_network([[[-0.980637623652979, -0.9927666879125988, 1.106559197252621,
                                         -0.5124464078897945, -1.931725839279701, -1.2630612292819454,
                                         0.5486362423068403, -1.3844228096492235, 2.386356282788793, 1.2112238373381692,
                                         3.297380513036414, -1.435423505683107, -1.363634650179468, 0.10406934738606936,
                                         0.3539034926516757, 2.9329729317941413, -1.3909125848087383,
                                         -0.18058612681361189, 2.8303585661693607, -1.1549787621660286,
                                         -1.812135525403505, 2.2441191850036217, 2.2889402221533297, 1.0790772756380624,
                                         0.8030452371482466, -0.16229678264489208, 0.20081826354906546,
                                         -0.995654614419787, 1.8652223728161903, -0.5558812521274753,
                                         0.6268497641470568, -1.3199840113281103, -0.8103770060844288,
                                         -0.8124411302513423, 0.3622205478413274, -1.4479741385156428],
                                        [-1.0035410626628654, -0.17914650122004022, 0.09413475261202253,
                                         -1.1905629274493004, 0.1901356526151223, -0.7128346643482029,
                                         2.1252803588232485, -1.4054736097005844, 0.4751639093879053,
                                         1.9001072115318423, -0.1480758055806779, -0.0004932710439627072,
                                         1.6433973988151958, -0.01039179088836136, -1.1318197832390309,
                                         1.2728012054949227, -1.4464608153520506, 1.9763234529189433,
                                         -2.8249095034389846, 3.1648075122756296, -1.7208668539786818,
                                         1.0203056048451862, -2.141678474590733, 1.3709688941663982, 1.1496292251174005,
                                         0.7548129565587506, 0.06847140316568585, -0.1360806106860235,
                                         -0.6478884810519208, 1.479902358440932, 0.5802342308076625, 1.2600893642667192,
                                         -1.9527426590322143, -0.04994664016069807, 1.4185019312085965,
                                         0.9897879226510962],
                                        [-0.8313300536447833, 1.2307259919340663, 0.7274753595725306,
                                         -0.06297563447396447, 1.0084570359880796, 1.8736430079092026,
                                         0.8466437734956351, -0.6272610876424445, -1.9416687123036882,
                                         0.5595121340008625, 0.5996105806828517, 1.8459164400215908, 0.6750265401306185,
                                         -0.04815085047453336, 0.7848937717569762, -0.2384782085894936,
                                         0.3198198323201399, 1.8520137697047627, 0.34967109537930025, 1.202583423116709,
                                         1.057473853587465, -0.7084000231632582, -0.38967335088701716,
                                         -2.2428656505769182, -0.23013072075999907, 1.7448823902974409,
                                         1.3924207694321311, -0.04161805565272174, -1.468662635143507,
                                         0.8704772357553467, 0.8204241948665845, -0.013306796229472187,
                                         -0.04376761937866759, -0.6586985745172029, -1.6466192541779905,
                                         -0.213361486976079],
                                        [-1.6956517831872489, -2.5299950598134853, -0.47496041639015546,
                                         0.5041866344190251, -1.1803500064213752, -2.5829805592276793,
                                         0.8267148690648596, 1.574327171824856, -1.7087761012681715,
                                         -0.6914187444792116, -0.18667166600452056, 1.452251747061129,
                                         -2.1798211605961297, -0.789162918975697, -1.1730125370061, 2.2320214350884213,
                                         2.930274383914736, -0.6437289254781277, -0.8615219425067183,
                                         -1.2960310470132292, 3.6251442088205708, -0.32815013111220676,
                                         0.4686335893938374, 0.8771819528692567, -0.5288072676073664,
                                         -0.3200416991446385, 0.4353036131835047, -0.13504167071509807,
                                         -0.1779148105003929, 0.13461275096137032, -0.10979721706582234,
                                         2.2381892854067127, 0.13717801674057345, 2.6005026317933857,
                                         -0.16347371883643974, 2.1302174346626437],
                                        [-0.44034648517493336, 0.08500916846219173, -1.5889430938167202,
                                         -0.6376895245672174, -1.1443975153999104, -0.36091141823399814,
                                         -0.37375643203867887, 1.4092369268588352, 2.327848396490097,
                                         0.8426481996357001, -2.1549730416447233, 0.9752386033308498, 1.61184789165129,
                                         1.9268058218115995, 0.745693848859597, -0.4324765206445262, 1.4800328653218413,
                                         0.04117937296431299, -0.48885858331460297, -0.658284929450025,
                                         0.8529094920299166, 1.666943921113827, 0.28597677048452735, 1.6027415299922412,
                                         1.1881166670015972, 1.1668427548463334, 1.1609686976905105, -1.5435729156975,
                                         1.451462689431116, 0.6410238084758044, 1.238862061746813,
                                         -0.011197789725447098, -0.5719361857346186, 0.6831018057871764,
                                         1.0972257184776095, 0.03410345931387473],
                                        [-0.9619359200285246, 0.20848067521141958, 0.11395197663540729,
                                         -0.36000061236956166, -1.0366154497031823, -0.02089824323793449,
                                         0.7329374675607466, 0.10052514145179152, 0.6980293865898201,
                                         0.23804376904756394, -0.28213977215087527, -2.1723999829749907,
                                         0.9782409830630759, 0.9662734067312532, -0.41823738422769513,
                                         0.10651807607718276, 0.010802001482711498, -1.5858231510053373,
                                         1.6530933396156071, 0.6068937548282827, 1.516117144451164, -2.805189645703569,
                                         -0.301255037291792, -1.6722747694937345, 0.21798959283841435,
                                         2.6281469529115538, 1.7321035366497506, -3.1386295026795485,
                                         0.5291690991699805, 1.355417499148144, 2.4989355754551963, -2.1200328658969805,
                                         -0.5326919158246242, 0.7392513392913348, 0.33744051841725003,
                                         -1.9580711669657447],
                                        [-1.4320190799534531, 1.3502651249996658, 0.8301814694354472,
                                         -0.20810935545168904, -0.25706221562583076, 1.4831331274722304,
                                         0.3115287360186406, -1.0286974875075707, -0.33563576092208686,
                                         0.3350426032925833, 0.6352826000094898, 0.7865103340111754,
                                         0.25310356610891893, -0.1758767915898711, 1.0963112209463897,
                                         -0.0801426344956705, 0.6364213712513457, 0.14282980663510078,
                                         -1.7515277607449014, -2.1543693344153434, -1.83466923521518, 3.139444650151232,
                                         1.0578834325880795, 0.0756487166689193, 0.03941138252043294,
                                         -0.9045089576515519, 2.707392392640217, 1.0909506753778002, -0.58995324254738,
                                         -3.379942316016447, 3.056906455939333, 0.8476993425118234, -0.0437178853713883,
                                         -0.4824802116453169, 2.1770596263810034, 1.4046431184102048],
                                        [-0.7767292766849782, 0.310818134417864, 0.5058349166729424,
                                         -1.1229416280769202, -0.5255249673916469, 0.07585352505389233,
                                         0.7640845437997765, -1.3602486208700684, 0.6844100314115551,
                                         1.0376460492401554, 1.1774742214796887, 2.261816489032661, 1.1990414788090322,
                                         -0.19404081984986335, 2.613364211476068, 0.7801803008111265,
                                         0.7353919809746746, 1.6983295207196265, -0.38048810537894234,
                                         -1.594159069205729, 2.1453504508518715, 2.373042131410515, 2.60871026050042,
                                         0.17452265435419126, 1.5255499182139318, 0.5149856759375432,
                                         -1.562773109763165, -0.28479057194173596, 0.22969766489764687,
                                         2.423175379120005, -1.2067504472493262, 0.012501428228830675,
                                         -0.5533550558592794, -1.0564988255287613, -1.2884464010940753,
                                         0.12482530668217573],
                                        [-0.4581454722199942, 0.4714958250577925, 0.9544409790130619,
                                         0.1060669454122136, 1.4071491647387036, 0.6962271967239546, 1.5584479896955699,
                                         -0.31271638113569455, 0.46569037316521067, 0.8484609773751501,
                                         0.45975250889347913, -3.3522847428963893, 0.8395771088020784,
                                         -0.3968588551190968, 1.3454537445132007, 0.714623047026614, 1.2249370371688193,
                                         -4.322597806326538, -1.899863641622796, 0.08922829121411231, 1.779430413733142,
                                         -2.851062939880694, 1.4938685207305231, 1.1717994441698452, 1.0056359128539136,
                                         1.1517747636204512, 0.2389320522433725, 0.7768883933089348,
                                         -0.6706748989757357, 0.6254284525817002, 0.5129764586565542,
                                         1.4281671565809797, -0.4791691237114579, 0.10971372249038858,
                                         0.8962611129731575, 1.5030469214868156],
                                        [-1.0361503305026742, 1.3531465124794904, 1.186216814145168, 0.3890845750347527,
                                         -1.6839937299132095, 1.6288710146797654, 2.251444839323781,
                                         -1.4279972551586266, 1.304179640105572, 0.3379007641733602,
                                         -0.14203429888067617, 2.6096686076025493, 0.744356953180974, 3.573307244019317,
                                         -0.4590828848238174, 1.0482931643442117, -3.8942598394242665,
                                         1.651606123468731, -1.50882044042128, -2.2536971295368846, 0.7954479344055891,
                                         0.10765533158427665, -1.4781901921224796, 0.7576930640632837,
                                         -0.4865853875397949, -1.5778179688634224, -0.2646228441986237,
                                         -0.042752538513273944, 2.300120077027116, -0.5880613481293012,
                                         -0.6354561721203321, 0.11475141542700638, 0.45425741353208604,
                                         0.9659216544184889, 0.9134173573266325, 0.3494268431704156]], [
                                           [-0.8553985166733428, 3.0204403004096227, -3.560085825398441,
                                            -0.03770285905083704, 6.278756748396855, 1.4964262043470444,
                                            0.692939738316401, 3.0158686593762836, 3.4022872459621674,
                                            2.1122119100451076, -0.6809877772102878],
                                           [3.493881444394398, 2.3817706706530704, -2.9931179992812145,
                                            -4.950775045703691, -0.5580822903012205, 2.6444615937871383,
                                            0.461563944129975, -2.3926732878433294, -1.6380400336443863,
                                            -1.5119306869343605, 3.455872952512634],
                                           [1.8708744391853829, -2.1074217742788726, 2.5279090555623864,
                                            -1.7420082151295075, 3.8379956589412054, -1.2890827711950055,
                                            -5.127786000792876, 1.2659444826962252, -1.4823699181808165,
                                            3.013816671344216, 1.157812903443463],
                                           [0.3541106301387624, 1.9256431072401512, 0.596654136575727,
                                            0.9388564279952942, -0.8976492308890615, -2.4782060984230556,
                                            5.986102439803784, -1.0234475023769238, -5.149639810458686,
                                            3.3392491670568947, -3.0224989701820744],
                                           [1.580963970969379, 0.9537157775932276, 4.087226772094183,
                                            -1.7951525146748941, -3.2682568264003677, 3.316819448214735,
                                            -0.47934181894394684, -1.398886062014581, 3.1821704949547973,
                                            1.8121854105281126, -3.158545382252508],
                                           [-0.02605548794927309, -4.730639745694573, 0.24098085582382653,
                                            2.288867192730541, -2.03664976667558, 2.2912120538013805, 2.165198645936143,
                                            1.8067152727444262, 0.2516179923572902, 2.5133827837833804,
                                            5.10454501106251],
                                           [2.391084506280661, -4.465525589102492, -1.0338999029470524,
                                            0.9486421538846289, 1.2172154061714688, 1.463895936332198,
                                            -1.3813803790292773, 0.44984586157994955, -2.456468709515099,
                                            -3.007108124561052, -4.783402446044662],
                                           [2.39579275243941, 0.07907408778546487, -4.552943300602597,
                                            0.5229387437216705, -5.17577188602283, -3.8890946009016054,
                                            -3.111551025878577, 0.4778344076059198, 0.6311463633507287,
                                            -0.5867000316707212, -1.2703299224111049],
                                           [0.2852434505608234, 4.475660094011102, 3.7516301200250632,
                                            1.0160596580071972, -2.0509007435124453, -0.1694164935993478,
                                            -1.1896541429438323, 3.778884267683543, 0.8520978853104448,
                                            -4.946493958756526, 3.5424088575575254],
                                           [1.9930300760585957, -1.383063557228001, 0.26162159485511777,
                                            2.9714215088747453, 1.9202906879279005, -1.4997551268472118,
                                            0.7219204143135182, -7.0712042827968835, 2.7805167796620176,
                                            -0.7410877644644898, 0.8062438399185262]]],
                                      hyp_tan_theta,
                                      hyp_tan_prime_theta)

    # network.initialize(35)

    noise_data = create_numbers_with_noise(clean_numbers, 3)

    print(network.forward_propagation(noise_data[0][2].tolist()))

    # testing
    # print(network.forward_propagation(noise_data[0][0].tolist()))
    # print(network.forward_propagation(noise_data[0][1*3].tolist()))
    # print(network.forward_propagation(noise_data[0][2*3].tolist()))
    # print(network.forward_propagation(noise_data[0][3*3].tolist()))
    # print(network.forward_propagation(noise_data[0][4*3].tolist()))
    # print(network.forward_propagation(noise_data[0][5*3].tolist()))
    # print(network.forward_propagation(noise_data[0][6*3].tolist()))
    # print(network.forward_propagation(noise_data[0][7*3].tolist()))
    # print(network.forward_propagation(noise_data[0][8*3].tolist()))
    # print(network.forward_propagation(noise_data[0][9*3].tolist()))

    # print(expected_output[0])


if __name__ == '__main__':
    main()
